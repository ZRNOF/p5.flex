/*!
 * p5.flex
 * Version: 0.2.0
 * Author: Zaron Chen
 * License: MIT
 *
 * Copyright (c) 2024 Zaron Chen
 */
const t="padding: 0; margin: 0; border: 0;",n="width: 100%; height: 100%;",e="display: flex; justify-content: center; align-items: center;",o="box-sizing: border-box;",a="position: static;",i={pageCSS:()=>{const o=document.documentElement,a=document.body;o.className="",a.className="",o.style.cssText=t+n,a.style.cssText=t+n+e},containerCSS:(t,n)=>{let a="";n.container.customBoxModel||(a=`\n\t\t\t\tmargin:  ${n.container.margin} ;\n\t\t\t\tpadding: ${n.container.padding};\n\t\t\t\tborder:  ${n.container.border} ;\n\t\t\t`),t.style.cssText=`\n\t\t\tmax-width:  ${n.container.width};\n\t\t\tmax-height: ${n.container.height};\n\t\t\twidth:  ${n.container.width};\n\t\t\theight: ${n.container.height};\n\t\t\t${o+e+a}\n\t\t`},canvasScaleCSS:t=>`\n\t\t\tmax-width:  ${100*t.canvas.scale}%;\n\t\t\tmax-height: ${100*t.canvas.scale}%;\n\t\t`,innerContainerCSS:(t,o)=>{let c=i.canvasScaleCSS(o)+a+e+"overflow: hidden;";"cover"===o.canvas.fit&&(c+=n),t.style.cssText=c},canvasCSS:(e,c)=>{const r=c.canvas.fit;let s=i.canvasScaleCSS(c);["cover","none"].includes(r)&&(s=""),"fill"===r&&(s+=n),e.elt.style.cssText=`\n\t\t\t${a+t+o+s+"display: block;"}\n\t\t`}},c={container:{id:void 0,parent:void 0,width:"100%",height:"100%",margin:"0",padding:"0",border:"0",customBoxModel:!1},canvas:{scale:1,fit:"contain"},stylePage:!0},r=(t,n)=>{const e=(o=c,a=n,{...o,...a,container:{...o.container,...a.container},canvas:{...o.canvas,...a.canvas}});var o,a;const r=e.canvas.fit,s=e.container.customBoxModel;e.stylePage&&i.pageCSS();const d=e.container.parent??document.body;e.container.parent=d;const l=document.createElement("div"),h=e.container.id??`p5-flex-container-${t.elt.id}`;let p;l.id=e.container.id=h,t.elt.container=l,i.containerCSS(l,e),l.classList.add("p5-flex-container"),d.appendChild(l),["cover","none"].includes(r)&&(p=document.createElement("div"),i.innerContainerCSS(p,e),l.appendChild(p));const g=()=>{const t=s?getComputedStyle(l):l.style,n=n=>parseFloat(t[`padding${n}`]);return[n("Top")+n("Bottom"),n("Left")+n("Right")]};let[v,u]=g(),S="",y="";const m=n=>{"container"===S&&y===n||(y=n,t.elt.style.width="width"===n?"100%":"",t.elt.style.height="height"===n?"100%":"")},C=()=>{requestAnimationFrame((()=>{s&&([v,u]=g());(l.clientWidth-u)/(l.clientHeight-v)>=t.width/t.height?("contain"===r&&m("height"),"cover"===r&&m("width")):("contain"===r&&m("width"),"cover"===r&&m("height"))}))};["contain","cover"].includes(r)&&new ResizeObserver((()=>{S="container",C()})).observe(l),i.canvasCSS(t,e),["cover","none"].includes(r)?(p.classList.add("p5-flex-canvas"),t.parent(p)):(t.elt.classList.add("p5-flex-canvas"),t.parent(l));const f=t.resize;t.resize=function(n,o){f.call(this,n,o),i.canvasCSS(t,e),["contain","cover"].includes(r)&&(S="canvas",C())}};export const mountFlex=t=>{t.prototype.flex=function(t={}){r(this._renderer,t)},t.prototype.getCanvas=function(){return this._renderer.elt},t.prototype.getContainer=function(){return this.getCanvas().container},t.prototype.getParent=function(){return this.getContainer().parentNode},t.prototype.containerBg=function(t){this.getContainer().style.background=t},t.prototype.containerBgColor=function(...t){const n=this._renderer._pInst.color(...t);this.getContainer().style.background=n.toString()},t.prototype.parentBg=function(t){this.getParent().style.background=t},t.prototype.parentBgColor=function(...t){const n=this._renderer._pInst.color(...t);this.getParent().style.background=n.toString()},t.prototype.NONE="none",t.prototype.SCALE_DOWN="scale_down"};